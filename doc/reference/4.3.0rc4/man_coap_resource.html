<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcoap: coap_resource(3)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libcoap
   &#160;<span id="projectnumber">4.3.0rc4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('man_coap_resource.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">coap_resource(3) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>coap_resource</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /></head><body><div xml:lang="en" class="refentry" lang="en"><a id="idm1"></a><div class="titlepage"></div><div class="refnamediv"><h2>NAME</h2><p>coap_resource, coap_resource_init, coap_resource_unknown_init, coap_resource_proxy_uri_init, coap_add_resource, coap_delete_resource, coap_resource_set_mode, coap_resource_set_userdata, coap_resource_get_userdata — Work with CoAP resources</p></div><div class="refsynopsisdiv"><a id="_synopsis"></a><h2>SYNOPSIS</h2><p><span class="strong"><strong>#include &lt;coap3/coap.h&gt;</strong></span></p><p><span class="strong"><strong>coap_resource_t *coap_resource_init(coap_str_const_t *<span class="emphasis"><em>uri_path</em></span>,
int <span class="emphasis"><em>flags</em></span>);</strong></span></p><p><span class="strong"><strong>coap_resource_t *coap_resource_unknown_init(coap_method_handler_t
<span class="emphasis"><em>put_handler</em></span>);</strong></span></p><p><span class="strong"><strong>coap_resource_t *coap_resource_proxy_uri_init(coap_method_handler_t
<span class="emphasis"><em>proxy_handler</em></span>, size_t <span class="emphasis"><em>host_name_count</em></span>, const char *<span class="emphasis"><em>host_name_list</em></span>[]);</strong></span></p><p><span class="strong"><strong>void coap_add_resource(coap_context_t *<span class="emphasis"><em>context</em></span>,
coap_resource_t *<span class="emphasis"><em>resource</em></span>);</strong></span></p><p><span class="strong"><strong>int coap_delete_resource(coap_context_t *<span class="emphasis"><em>context</em></span>,
coap_resource_t *<span class="emphasis"><em>resource</em></span>);</strong></span></p><p><span class="strong"><strong>void coap_resource_set_mode(coap_resource_t *<span class="emphasis"><em>resource</em></span>, int <span class="emphasis"><em>mode</em></span>);</strong></span></p><p><span class="strong"><strong>void coap_resource_set_userdata(coap_resource_t *<span class="emphasis"><em>resource</em></span>, void *<span class="emphasis"><em>data</em></span>);</strong></span></p><p><span class="strong"><strong>void *coap_resource_get_userdata(coap_resource_t *<span class="emphasis"><em>resource</em></span>);</strong></span></p><p><span class="strong"><strong>void coap_resource_release_userdata_handler(coap_context_t *<span class="emphasis"><em>context</em></span>,
coap_resource_release_userdata_handler_t <span class="emphasis"><em>callback</em></span>);</strong></span></p><p><span class="strong"><strong>coap_str_const_t *coap_resource_get_uri_path(coap_resource_t *<span class="emphasis"><em>resource</em></span>);</strong></span></p><p>For specific (D)TLS library support, link with
<span class="strong"><strong>-lcoap-3-notls</strong></span>, <span class="strong"><strong>-lcoap-3-gnutls</strong></span>,
<span class="strong"><strong>-lcoap-3-openssl</strong></span>, <span class="strong"><strong>-lcoap-3-mbedtls</strong></span>
or <span class="strong"><strong>-lcoap-3-tinydtls</strong></span>.   Otherwise, link with
<span class="strong"><strong>-lcoap-3</strong></span> to get the default (D)TLS library support.</p></div><div class="refsect1"><a id="_description"></a><h2>DESCRIPTION</h2><p>CoAP Resources on a CoAP Server need to be created and updated etc. The URI in
the request packet defines the resource to work with, with possibly the Query
referring to a sub-resource.</p><p>When resources are configured on the CoAP server, the URI to match against
in the request packet is specified.</p><p>Callback Handlers are then added to the resource to handle the different
request methods.</p><p>Adding Attributes allows textual information to be added to the resource
which can then be reported back to any client doing a "GET .well-known/core"
request.</p><p>If an incoming packet request matches a resource’s URI and Method, then
the appropriate callback resource handler is invoked to process the packet
which then should update a suitable response packet for sending back to the
requester.</p><p>There is support for handling incoming packets where the URI is unknown.
This could, for example, happen when a PUT request is trying to create a new
resource. It is the responsibility of the unknown resource callback handler
to either create a new resource for the URI or just manage things separately.</p><p>CoAP Observe (RFC 7641) is not supported for unknown resources, so a new
resource with GET handler must be created by the unknown resource callback
handle matching the URI which then can be Observable.</p><p>The <span class="strong"><strong>coap_resource_init</strong></span>() function returns a newly created <span class="emphasis"><em>resource</em></span> of
type <span class="emphasis"><em>coap_resource_t</em></span> * .  <span class="emphasis"><em>uri_path</em></span> specifies the uri string path to match
against.  <span class="emphasis"><em>flags</em></span> is used to define whether the
<span class="emphasis"><em>resource</em></span> is of type Confirmable Message or Non-Confirmable Message for
any "observe" responses.  See <a href="man_coap_observe.html" target="_self"><span class="strong"><strong>coap_observe</strong></span>(3)</a>.
<span class="emphasis"><em>flags</em></span> can be one of the following definitions or’ed together.</p><div class="horizontal"><table class="horizontal" cellpadding="4px" style="border: none;"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td style="" valign="top">
<p>
<span class="strong"><strong>COAP_RESOURCE_FLAGS_NOTIFY_NON</strong></span>
</p>
</td><td style="" valign="top">
<p>
Set the notification message type to non-confirmable for any trigggered
"observe" responses with type set to confirmable every 5 packets as required by
RFC7641 section-4.5.
</p>
</td></tr><tr><td style="" valign="top">
<p>
<span class="strong"><strong>COAP_RESOURCE_FLAGS_NOTIFY_NON_ALWAYS</strong></span>
</p>
</td><td style="" valign="top">
<p>
Set the notification message type to always non-confirmable for any trigggered
"observe" responses. This should only be used if a upper layer protocol
requires it.
</p>
</td></tr><tr><td style="" valign="top">
<p>
<span class="strong"><strong>COAP_RESOURCE_FLAGS_NOTIFY_CON</strong></span>
</p>
</td><td style="" valign="top">
<p>
Set the notification message type to confirmable for any trigggered
"observe" responses.
</p>
</td></tr><tr><td style="" valign="top">
<p>
<span class="strong"><strong>COAP_RESOURCE_FLAGS_RELEASE_URI</strong></span>
</p>
</td><td style="" valign="top">
<p>
Free off the coap_str_const_t for <span class="emphasis"><em>uri_path</em></span> when the <span class="emphasis"><em>resource</em></span> is deleted.
</p>
</td></tr></tbody></table></div><p><span class="strong"><strong>NOTE:</strong></span> <span class="emphasis"><em>uri_path</em></span>, if not 7 bit readable ASCII, binary bytes must be hex
encoded according to the rules defined in RFC3968 Section 2.1.</p><p>The <span class="strong"><strong>coap_resource_unknown_init</strong></span>() function returns a newly created <span class="emphasis"><em>resource</em></span>
of type <span class="emphasis"><em>coap_resource_t</em></span> *. <span class="emphasis"><em>put_handler</em></span> is automatically added to the
<span class="emphasis"><em>resource</em></span> to handle PUT requests to resources that are unknown. Additional
handlers can be added to this resource if required.</p><p>The <span class="strong"><strong>coap_resource_proxy_uri_init</strong></span>() function returns a newly created
<span class="emphasis"><em>resource</em></span> of type <span class="emphasis"><em>coap_resource_t</em></span> *. <span class="emphasis"><em>proxy_handler</em></span> is automatically added
to the <span class="emphasis"><em>resource</em></span> to handle PUT/POST/GET etc. requests that use the Proxy-Uri:
option.  There is no need to add explicit request type handlers. One or more
names by which the proxy is known by (IP address, DNS name etc.) must be
supplied in the array defined by <span class="emphasis"><em>host_name_list</em></span>[] which has a count of
<span class="emphasis"><em>host_name_count</em></span>.  This is used to check whether the current endpoint is
the proxy target address.</p><p>The <span class="strong"><strong>coap_add_resource</strong></span>() function registers the given <span class="emphasis"><em>resource</em></span> with the
<span class="emphasis"><em>context</em></span>. The <span class="emphasis"><em>resource</em></span> must have been created by <span class="strong"><strong>coap_resource_init</strong></span>(),
<span class="strong"><strong>coap_resource_unknown_init</strong></span>() or <span class="strong"><strong>coap_resource_proxy_uri_init</strong></span>(). The storage
allocated for the <span class="emphasis"><em>resource</em></span> will be released by <span class="strong"><strong>coap_delete_resource</strong></span>().</p><p>As the <span class="emphasis"><em>uri_path</em></span> of the resource has to be unique across all of the resources
associated with a <span class="emphasis"><em>context</em></span>, <span class="strong"><strong>coap_add_resource</strong></span>() (or
<span class="strong"><strong>coap_add_resource_release</strong></span>()) will delete any previous
<span class="emphasis"><em>resource</em></span> with the same <span class="emphasis"><em>uri_path</em></span> before adding in the new <span class="emphasis"><em>resource</em></span>.</p><p>The <span class="strong"><strong>coap_delete_resource</strong></span>() function deletes a <span class="emphasis"><em>resource</em></span> identified by
<span class="emphasis"><em>resource</em></span> from <span class="emphasis"><em>context</em></span>. The storage allocated for that <span class="emphasis"><em>resource</em></span> is freed,
along with any attrigutes associated with the <span class="emphasis"><em>resource</em></span>.</p><p>The <span class="strong"><strong>coap_resource_set_mode</strong></span>() changes the notification message type of
<span class="emphasis"><em>resource</em></span> to the given <span class="emphasis"><em>mode</em></span> which must be one of
COAP_RESOURCE_FLAGS_NOTIFY_NON, COAP_RESOURCE_FLAGS_NOTIFY_NON_ALWAYS or
COAP_RESOURCE_FLAGS_NOTIFY_CON.</p><p>The <span class="strong"><strong>coap_resource_set_userdata</strong></span>() function allows a pointer to user <span class="emphasis"><em>data</em></span>
to be associated with a <span class="emphasis"><em>resource</em></span> that can accessed in any callback that
includes <span class="emphasis"><em>resource</em></span> as a parameter.</p><p><span class="strong"><strong>NOTE:</strong></span> <span class="emphasis"><em>data</em></span> must point to a static, or allocated, block of memory.</p><p>The <span class="strong"><strong>coap_resource_get_userdata</strong></span>() function obtains the user data pointer
from the <span class="emphasis"><em>resource</em></span> that had previously been set up by
<span class="strong"><strong>coap_resource_set_userdata</strong></span>().</p><p>The <span class="strong"><strong>coap_resource_release_userdata_handler</strong></span>() function defines the <span class="emphasis"><em>context</em></span>
wide <span class="emphasis"><em>callback</em></span> handler to call to release the allocated user data that has
been added to the resource using <span class="strong"><strong>coap_resource_set_userdata</strong></span>() when the
resource is deleted. <span class="emphasis"><em>callback</em></span> can be NULL (which is the default) if nothing
needs to be freed off.</p><p>The <span class="strong"><strong>coap_resource_get_uri_path</strong></span>() function is used to obtain the UriPath of
the <span class="emphasis"><em>resource</em></span> definion.</p></div><div class="refsect1"><a id="_return_values"></a><h2>RETURN VALUES</h2><p>The <span class="strong"><strong>coap_resource_init</strong></span>(), <span class="strong"><strong>coap_resource_unknown_init</strong></span>() and
<span class="strong"><strong>coap_resource_proxy_uri_init</strong></span>() functions return a newly created resource
or NULL if there is a malloc failure.</p><p>The <span class="strong"><strong>coap_delete_resource</strong></span>() function return 0 on failure (<span class="emphasis"><em>resource</em></span> not
found), 1 on success.</p><p>The <span class="strong"><strong>coap_resource_get_userdata</strong></span>() function returns the value previously set
by the <span class="strong"><strong>coap_resource_set_userdata</strong></span>() function or NULL.</p><p>The <span class="strong"><strong>coap_resource_get_uri_path</strong></span>() function returns the uri_path or NULL if
there was a failure.</p></div><div class="refsect1"><a id="_examples"></a><h2>EXAMPLES</h2><p><span class="strong"><strong>Fixed Resources Set Up</strong></span></p><pre class="programlisting">#include &lt;coap3/coap.h&gt;

#define INDEX "This is an example server using libcoap\n"

static void
hnd_get_index(coap_resource_t *resource, coap_session_t *session,
const coap_pdu_t *request, const coap_string_t *query, coap_pdu_t *response) {
  unsigned char buf[3];
  /* Remove (void) definition if variable is used */
  (void)resource;
  (void)session;
  (void)request;
  (void)query;

  coap_pdu_set_code(response, COAP_RESPONSE_CODE_CONTENT);

  coap_add_option(response,
                  COAP_OPTION_CONTENT_TYPE,
                  coap_encode_var_safe(buf, sizeof(buf),
                                       COAP_MEDIATYPE_TEXT_PLAIN),
                  buf);

  coap_add_option(response,
                  COAP_OPTION_MAXAGE,
                  coap_encode_var_safe(buf, sizeof(buf), 0x2ffff), buf);

  coap_add_data(response, strlen(INDEX), (const uint8_t *)INDEX);

  coap_pdu_set_code(response, COAP_RESPONSE_CODE_CONTENT);
}

static void
hnd_delete_time(coap_resource_t *resource, coap_session_t *session,
const coap_pdu_t *request, const coap_string_t *query, coap_pdu_t *response) {
  /* Remove (void) definition if variable is used */
  (void)resource;
  (void)session;
  (void)request;
  (void)query;

  /* .. code .. */

  coap_pdu_set_code(response, COAP_RESPONSE_CODE_DELETED);
}

static void
hnd_get_time(coap_resource_t *resource, coap_session_t *session,
const coap_pdu_t *request, const coap_string_t *query, coap_pdu_t *response) {
  /* Remove (void) definition if variable is used */
  (void)resource;
  (void)session;
  (void)request;
  (void)query;
  (void)response;

  /* .. code .. */

  coap_pdu_set_code(response, COAP_RESPONSE_CODE_CONTENT);
}

static void
hnd_put_time(coap_resource_t *resource, coap_session_t *session,
const coap_pdu_t *request, const coap_string_t *query, coap_pdu_t *response) {
  /* Remove (void) definition if variable is used */
  (void)resource;
  (void)session;
  (void)request;
  (void)query;
  (void)response;

  /* .. code .. */

  coap_pdu_set_code(response, COAP_RESPONSE_CODE_CHANGED);
}

static void
init_resources(coap_context_t *ctx) {

  coap_resource_t *r;

  /* Create a resource to return general information */
  r = coap_resource_init(NULL, 0);
  coap_register_handler(r, COAP_REQUEST_GET, hnd_get_index);

  /* Document resource for '.well-known/core' request */
  coap_add_attr(r, coap_make_str_const("ct"), coap_make_str_const("0"), 0);
  coap_add_attr(r, coap_make_str_const("title"),
                coap_make_str_const("\"General Info\""), 0);

  coap_add_resource(ctx, r);

  /* Create a resource to return return or update time */
  r = coap_resource_init(coap_make_str_const("time"),
                         COAP_RESOURCE_FLAGS_NOTIFY_CON);
  coap_resource_set_get_observable(r, 1);
  coap_register_handler(r, COAP_REQUEST_GET, hnd_get_time);
  coap_register_handler(r, COAP_REQUEST_PUT, hnd_put_time);
  coap_register_handler(r, COAP_REQUEST_DELETE, hnd_delete_time);

  /* Document resource for 'time' request */
  coap_add_attr(r, coap_make_str_const("ct"), coap_make_str_const("0"), 0);
  coap_add_attr(r, coap_make_str_const("title"),
                coap_make_str_const("\"Internal Clock\""), 0);
  coap_add_attr(r, coap_make_str_const("rt"), coap_make_str_const("\"secs\""),
                0);
  coap_add_attr(r, coap_make_str_const("if"), coap_make_str_const("\"clock\""),
                0);

  coap_add_resource(ctx, r);

}</pre><p><span class="strong"><strong>Dynamic Resources Set Up</strong></span></p><pre class="programlisting">#include &lt;coap3/coap.h&gt;

/* Regular DELETE handler - used by resources created by the
 * Unknown Resource PUT handler */

static void
hnd_delete(coap_resource_t *resource, coap_session_t *session,
const coap_pdu_t *request, const coap_string_t *query, coap_pdu_t *response) {
  /* Remove (void) definition if variable is used */
  (void)session;
  (void)request;
  (void)query;
  (void)response;

  /* .. code .. */

  /* Dynamic resource no longer required - delete it */
  coap_delete_resource(coap_session_get_context(session), resource);

  coap_pdu_set_code(response, COAP_RESPONSE_CODE_DELETED);
}

/* Regular GET handler - used by resources created by the
 * Unknown Resource PUT handler */

static void
hnd_get(coap_resource_t *resource, coap_session_t *session,
const coap_pdu_t *request, const coap_string_t *query, coap_pdu_t *response) {

  coap_str_const_t *get_uri_path;
  /* Remove (void) definition if variable is used */
  (void)resource;
  (void)session;
  (void)request;
  (void)query;
  (void)response;

  /*
   * request will be NULL if an Observe triggered request, so the uri_path,
   * if needed, must be abstracted from the resource.
   * The uri_path string is a const pointer
   */

  get_uri_path = coap_resource_get_uri_path(resource);

  /* .. code .. */

  coap_pdu_set_code(response, COAP_RESPONSE_CODE_CONTENT);
}

/* Regular PUT handler - used by resources created by the
 * Unknown Resource PUT handler */

static void
hnd_put(coap_resource_t *resource, coap_session_t *session,
const coap_pdu_t *request, const coap_string_t *query, coap_pdu_t *response) {
  /* Remove (void) definition if variable is used */
  (void)resource;
  (void)session;
  (void)query;

  coap_string_t *put_uri_path;
  size_t length;
  const uint8_t *data;
  size_t offset;
  size_t total;
  int new_resource = 0;

  /* get the uri_path */
  put_uri_path = coap_get_uri_path(request);
  if (!put_uri_path) {
    coap_pdu_set_code(response, COAP_RESPONSE_CODE_NOT_FOUND);
    return;
  }
  coap_get_data_large(request, &amp;length, &amp;data, &amp;offset, &amp;total);

  /* .. code .. */

  /* Need to do this as coap_get_uri_path() created it */
  coap_delete_string(put_uri_path);

  if (length + offset &lt; total)
    coap_pdu_set_code(response, COAP_RESPONSE_CODE_CONTINUE);
  else if (new_resource)
    coap_pdu_set_code(response, COAP_RESPONSE_CODE_CREATED);
  else
    coap_pdu_set_code(response, COAP_RESPONSE_CODE_CHANGED);
}

static int
check_url_fn(coap_string_t *uri_path, uint8_t code) {
  /* Remove (void) definition if variable is used */
  (void)uri_path;
  (void)code;

  /* Code to determine whether the uri is valid or not */

  return 1;
}

/* Unknown Resource PUT handler */

static void
hnd_unknown_put(coap_resource_t *resource, coap_session_t *session,
const coap_pdu_t *request, const coap_string_t *query, coap_pdu_t *response) {
  /* Remove (void) definition if variable is used */
  (void)resource;
  coap_pdu_code_t req_code = coap_pdu_get_code(request);

  coap_resource_t *r;
  coap_string_t *uri_path;

  /* get the uri_path - which will get used by coap_resource_init() */
  uri_path = coap_get_uri_path(request);
  if (!uri_path) {
    coap_pdu_set_code(response, COAP_RESPONSE_CODE_NOT_FOUND);
    return;
  }

  /* Check if new URI Path is valid */
  if (!check_url_fn (uri_path, req_code)) {
    coap_pdu_set_code(response, COAP_RESPONSE_CODE_NOT_FOUND);
    coap_delete_string(uri_path);
    return;
  }

  /*
   * Create a resource to handle the new URI
   * uri_path will get deleted when the resource is removed
   */
  r = coap_resource_init((coap_str_const_t*)uri_path,
        COAP_RESOURCE_FLAGS_RELEASE_URI | COAP_RESOURCE_FLAGS_NOTIFY_NON);
  coap_register_handler(r, COAP_REQUEST_PUT, hnd_put);
  coap_register_handler(r, COAP_REQUEST_DELETE, hnd_delete);
  /* We possibly want to Observe the GETs */
  coap_resource_set_get_observable(r, 1);
  coap_register_handler(r, COAP_REQUEST_GET, hnd_get);
  coap_add_resource(coap_session_get_context(session), r);

  /* Do the PUT for this first call */
  hnd_put(r, session, request, query, response);

  return;

}

/* Initialize single Unknown Resource PUT handler */

static void
init_resources(coap_context_t *ctx) {

  coap_resource_t *r;

  /* Create a resource to handle PUTs to unknown URIs */
  r = coap_resource_unknown_init(hnd_unknown_put);
  /*
   * Additional handlers can be added - for example
   *  coap_register_handler(r, COAP_REQUEST_POST, hnd_post_unknown);
   *  coap_register_handler(r, COAP_REQUEST_GET, hnd_get_unknown);
   *  coap_register_handler(r, COAP_REQUEST_DELETE, hnd_delete_unknown);
   */
  coap_add_resource(ctx, r);

}</pre></div><div class="refsect1"><a id="_see_also"></a><h2>SEE ALSO</h2><p><a href="man_coap_attribute.html" target="_self"><span class="strong"><strong>coap_attribute</strong></span>(3)</a>, <a href="man_coap_context.html" target="_self"><span class="strong"><strong>coap_context</strong></span>(3)</a>, <a href="man_coap_observe.html" target="_self"><span class="strong"><strong>coap_observe</strong></span>(3)</a> and <a href="man_coap_handler.html" target="_self"><span class="strong"><strong>coap_handler</strong></span>(3)</a></p></div><div class="refsect1"><a id="_further_information"></a><h2>FURTHER INFORMATION</h2><p>See "RFC7252: The Constrained Application Protocol (CoAP)" for further
information.</p></div><div class="refsect1"><a id="_bugs"></a><h2>BUGS</h2><p>Please report bugs on the mailing list for libcoap:
<a class="ulink" href="mailto:libcoap-developers@lists.sourceforge.net" target="_top">libcoap-developers@lists.sourceforge.net</a> or raise an issue on GitHub at
<a class="ulink" href="https://github.com/obgm/libcoap/issues" target="_top">https://github.com/obgm/libcoap/issues</a></p></div><div class="refsect1"><a id="_authors"></a><h2>AUTHORS</h2><p>The libcoap project &lt;<a class="ulink" href="mailto:libcoap-developers@lists.sourceforge.net" target="_top">libcoap-developers@lists.sourceforge.net</a>&gt;</p></div></div></body></html> coap_resource(3) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jun 16 2021 08:11:07 for libcoap by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
