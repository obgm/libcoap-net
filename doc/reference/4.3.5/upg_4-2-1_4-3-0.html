<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcoap: 4.2.1_4.3.0</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libcoap<span id="projectnumber">&#160;4.3.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('upg_4-2-1_4-3-0.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">4.2.1_4.3.0</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Upgrade from 4.2.1 to 4.3.0</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /></head><body><div xml:lang="en" class="article" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="idm1"></a>Upgrade from 4.2.1 to 4.3.0</h2></div></div><hr /></div><div class="section"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#_summary">1. Summary</a></span></dt><dt><span class="section"><a href="#_include_directory_changes">2. Include directory changes</a></span></dt><dd><dl><dt><span class="section"><a href="#_update_coap2_to_coap3">2.1. Update coap2 to coap3</a></span></dt></dl></dd><dt><span class="section"><a href="#_call_back_handler_updates">3. Call-back handler updates</a></span></dt><dd><dl><dt><span class="section"><a href="#_coap_register_handler">3.1. coap_register_handler()</a></span></dt><dt><span class="section"><a href="#_coap_register_response_handler">3.2. coap_register_response_handler()</a></span></dt><dt><span class="section"><a href="#_coap_register_nack_handler">3.3. coap_register_nack_handler()</a></span></dt><dt><span class="section"><a href="#_coap_register_event_handler">3.4. coap_register_event_handler()</a></span></dt><dt><span class="section"><a href="#_coap_register_ping_handler">3.5. coap_register_ping_handler()</a></span></dt><dt><span class="section"><a href="#_coap_register_pong_handler">3.6. coap_register_pong_handler()</a></span></dt></dl></dd><dt><span class="section"><a href="#_libcoap_structures_no_longer_directly_accessible">4. libcoap structures no longer directly accessible</a></span></dt><dd><dl><dt><span class="section"><a href="#_coap_pdu_t_code_variable">4.1. coap_pdu_t code variable</a></span></dt><dt><span class="section"><a href="#_coap_pdu_t_type_variable">4.2. coap_pdu_t type variable</a></span></dt><dt><span class="section"><a href="#_coap_pdu_t_token_variable">4.3. coap_pdu_t token variable</a></span></dt><dt><span class="section"><a href="#_coap_session_t_context_variable">4.4. coap_session_t context variable</a></span></dt><dt><span class="section"><a href="#_coap_session_t_proto_variable">4.5. coap_session_t proto variable</a></span></dt></dl></dd><dt><span class="section"><a href="#_functions_with_changed_parameters">5. Functions with changed parameters</a></span></dt><dd><dl><dt><span class="section"><a href="#_coap_pdu_init">5.1. coap_pdu_init()</a></span></dt><dt><span class="section"><a href="#_coap_get_data">5.2. coap_get_data()</a></span></dt></dl></dd><dt><span class="section"><a href="#_large_data_handling">6. Large Data Handling</a></span></dt><dd><dl><dt><span class="section"><a href="#_application_does_all_the_work">6.1. Application does all the work</a></span></dt><dt><span class="section"><a href="#_application_sees_individual_blocks">6.2. Application sees individual blocks</a></span></dt><dt><span class="section"><a href="#_application_only_sees_all_the_data">6.3. Application only sees all the data</a></span></dt></dl></dd><dt><span class="section"><a href="#_observe_handling">7. Observe Handling</a></span></dt><dt><span class="section"><a href="#_unused_function_parameters">8. Unused function parameters</a></span></dt><dt><span class="section"><a href="#_coap_message_ids">9. CoAP Message IDs</a></span></dt><dt><span class="section"><a href="#_async_support">10. Async Support</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_summary"></a>1. Summary</h2></div></div></div><p>When compiling 4.2.1 based code with a 4.3.0 environment, this will initially
throw up many errors as the API has been updated to make future coding simpler,
adds more functionality and adds more rigorous coding checks.  Updating your
code with the following steps will significantly reduce the reported issues.</p><p>The examples are now also named with the (D)TLS library type as a suffix.
E.g. coap-client is now coap-client-openssl.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_include_directory_changes"></a>2. Include directory changes</h2></div></div></div><p>Because of the API changes, the libcoap’s include file directory has changed from <code class="literal">coap2/</code> to <code class="literal">coap3/</code>. Also, there is now no need to define additional include paths to the compiler options such as <code class="literal">-I include/coap3</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_update_coap2_to_coap3"></a>2.1. Update coap2 to coap3</h3></div></div></div><p>Example</p><pre class="screen">4.2.1
  #include &lt;coap2/coap.h&gt;
4.3.0
  #include &lt;coap3/coap.h&gt;</pre><p>No other libcoap include files need to be included in your application.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_call_back_handler_updates"></a>3. Call-back handler updates</h2></div></div></div><p>Infrequently used parameters (which can easily be recreated) have been removed
and others have been made const.  These call-back handlers are those
registered with the <code class="literal">coap_register_*()</code> functions as follows:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_register_handler"></a>3.1. coap_register_handler()</h3></div></div></div><p>The definition of <code class="literal">coap_method_handler_t</code> has been updated, so all the
functions registered by <code class="literal">coap_register_handler()</code> need to be updated. Any
application functions called by these functions may need to include <code class="literal">const</code> in
their calling parameters.</p><p>Example</p><pre class="screen">4.2.1
static void
  hnd_get_time(coap_context_t *context,
               coap_resource_t *resource,
               coap_session_t *session,
               coap_pdu_t *request,
               coap_binary_t *token,
               coap_string_t *query,
               coap_pdu_t *response) {
4.3.0
  static void
  hnd_get_time(coap_resource_t *resource,
               coap_session_t *session,
               const coap_pdu_t *request,
               const coap_string_t *query,
               coap_pdu_t *response) {</pre><p>If <code class="literal">context</code> or <code class="literal">token</code> need to be recreated, this is done by</p><pre class="screen">  coap_context_t *context = coap_session_get_context(session);
  coap_bin_const_t rcvd_token = coap_pdu_get_token(request);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_register_response_handler"></a>3.2. coap_register_response_handler()</h3></div></div></div><p>The definition of <code class="literal">coap_response_handler_t</code> has been updated, so all the
functions registered by <code class="literal">coap_register_response_handler()</code> need to be updated.
Any application functions called by these functions may need to include <code class="literal">const</code>
in their calling parameters.  There is a new handler function exit code
<code class="literal">COAP_RESPONSE_FAIL</code> (if the response is not liked and needs to be rejected
with a <code class="literal">RST</code> packet) or <code class="literal">COAP_RESPONSE_OK</code>. Note that <code class="literal">coap_tid_t</code> has been
replaced with <code class="literal">coap_mid_t</code> to reflect the parameter is the message id.</p><p>Example</p><pre class="screen">4.2.1
  static void
  message_handler(struct coap_context_t *context,
                  coap_session_t *session,
                  coap_pdu_t *sent,
                  coap_pdu_t *received,
                  const coap_tid_t id) {
4.3.0
  static coap_response_t
  message_handler(coap_session_t *session,
                  const coap_pdu_t *sent,
                  const coap_pdu_t *received,
                  const coap_mid_t mid) {</pre><p>If <code class="literal">context</code> needs to be recreated, this is done by</p><pre class="screen">  coap_context_t *context = coap_session_get_context(session);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_register_nack_handler"></a>3.3. coap_register_nack_handler()</h3></div></div></div><p>The definition of <code class="literal">coap_nack_handler_t</code> has been updated, so all the functions
registered by <code class="literal">coap_register_nack_handler()</code> need to be updated. Any
application functions called by these functions may need to include <code class="literal">const</code> in
their calling parameters. Note that <code class="literal">coap_tid_t</code> has been replaced with
<code class="literal">coap_mid_t</code> to reflect the parameter is the message id.</p><p>Example</p><pre class="screen">4.2.1
  static void
  nack_handler(coap_context_t *context,
               coap_session_t *session,
               coap_pdu_t *sent,
               coap_nack_reason_t reason,
               const coap_tid_t id) {
4.3.0
  static void
  nack_handler(coap_session_t *session,
               const coap_pdu_t *sent,
               const coap_nack_reason_t reason,
               const coap_mid_t mid) {</pre><p>If <code class="literal">context</code> needs to be recreated, this is done by</p><pre class="screen">  coap_context_t *context = coap_session_get_context(session);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_register_event_handler"></a>3.4. coap_register_event_handler()</h3></div></div></div><p>The definition of <code class="literal">coap_event_handler_t</code> been updated, so all the functions
registered by <code class="literal">coap_register_event_handler()</code> need to be updated. Any
application functions called by these functions may need to include <code class="literal">const</code> in
their calling parameters.</p><p>Example</p><pre class="screen">4.2.1
  static int
  event_handler(coap_context_t *context,
                coap_event_t event,
                struct coap_session_t *session) {
4.3.0
  static int
  event_handler(coap_session_t *session,
                const coap_event_t event) {</pre><p>Note the reversed order of the parameters. If <code class="literal">context</code> needs to be
recreated, this is done by</p><pre class="screen">  coap_context_t *context = coap_session_get_context(session);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_register_ping_handler"></a>3.5. coap_register_ping_handler()</h3></div></div></div><p>The definition of <code class="literal">coap_ping_handler_t</code> been updated, so all the functions
registered by <code class="literal">coap_register_ping_handler()</code> need to be updated. Any
application functions called by these functions may need to include <code class="literal">const</code> in
their calling parameters. Note that <code class="literal">coap_tid_t</code> has been replaced with
<code class="literal">coap_mid_t</code> to reflect the parameter is the message id.</p><p>Example</p><pre class="screen">4.2.1
  void
  ping_handler(coap_context_t *context,
               coap_session_t *session,
               coap_pdu_t *received,
               const coap_tid_t id);
4.3.0
  void
  ping_handler(coap_session_t *session,
               const coap_pdu_t *received,
               const coap_mid_t mid);</pre><p>If <code class="literal">context</code> needs to be recreated, this is done by</p><pre class="screen">  coap_context_t *context = coap_session_get_context(session);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_register_pong_handler"></a>3.6. coap_register_pong_handler()</h3></div></div></div><p>The definition of <code class="literal">coap_pong_handler_t</code> been updated, so all the functions
registered by <code class="literal">coap_register_pong_handler()</code> need to be updated. Any
application functions called by these functions may need to include <code class="literal">const</code> in
their calling parameters. Note that <code class="literal">coap_tid_t</code> has been replaced with
<code class="literal">coap_mid_t</code> to reflect the parameter is the message id.</p><p>Example</p><pre class="screen">4.2.1
  void
  pong_handler(coap_context_t *context,
               coap_session_t *session,
               coap_pdu_t *received,
               const coap_tid_t id);
4.3.0
  void
  pong_handler(coap_session_t *session,
               const coap_pdu_t *received,
               const coap_mid_t mid);</pre><p>If <code class="literal">context</code> needs to be recreated, this is done by</p><pre class="screen">  coap_context_t *context = coap_session_get_context(session);</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_libcoap_structures_no_longer_directly_accessible"></a>4. libcoap structures no longer directly accessible</h2></div></div></div><p>Many of the structures internally used by libcoap are no longer exposed to
applications. Additional functions of the form <code class="literal">coap_X_get_Y()</code> and
<code class="literal">coap_X_set_Y()</code> where <code class="literal">X</code> is the structure type and <code class="literal">Y</code> is the variable. Below
is a non exhaustive set of examples,</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_pdu_t_code_variable"></a>4.1. coap_pdu_t code variable</h3></div></div></div><p>Example</p><pre class="screen">4.2.1
  if (received-&gt;code ==
4.3.0
  coap_pdu_code_t rcvd_code = coap_pdu_get_code(received);
  ...
  if (rcvd_code ==</pre><p>Example</p><pre class="screen">4.2.1
  response-&gt;code = COAP_RESPONSE_CODE(404);
4.3.0
  coap_pdu_set_code(response, COAP_RESPONSE_CODE_NOT_FOUND);</pre><p>Note that more descriptive names are now supported for the response codes, but
the old form can still be used.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_pdu_t_type_variable"></a>4.2. coap_pdu_t type variable</h3></div></div></div><p>Example</p><pre class="screen">4.2.1
  if (received-&gt;type ==
4.3.0
  coap_pdu_code_t rcvd_type = coap_pdu_get_type(received);
  ...
  if (rcvd_type ==</pre><p>Example</p><pre class="screen">4.2.1
  request-&gt;type = COAP_MESSAGE_NON;
4.3.0
  coap_pdu_set_type(request, COAP_MESSAGE_NON);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_pdu_t_token_variable"></a>4.3. coap_pdu_t token variable</h3></div></div></div><p>Example</p><pre class="screen">4.2.1
  static inline int
  check_token(coap_pdu_t *received) {
    return received-&gt;token_length == the_token.length &amp;&amp;
      memcmp(received-&gt;token, the_token.s, the_token.length) == 0;
  }
4.3.0
  static inline int
  check_token(const coap_pdu_t *received) {
    coap_bin_const_t rcvd_token = coap_pdu_get_token(received);

    return rcvd_token.length == the_token.length &amp;&amp;
      memcmp(rcvd_token.s, the_token.s, the_token.length) == 0;
  }</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_session_t_context_variable"></a>4.4. coap_session_t context variable</h3></div></div></div><p>Example</p><pre class="screen">4.2.1
  if (session-&gt;context ==
4.3.0
  coap_context_t context = coap_session_get_context(session);
  ...
  if (context ==</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_session_t_proto_variable"></a>4.5. coap_session_t proto variable</h3></div></div></div><p>Example</p><pre class="screen">4.2.1
  if (session-&gt;proto ==
4.3.0
  coap_proto_t proto = coap_session_get_proto(session);
  ...
  if (proto ==</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_functions_with_changed_parameters"></a>5. Functions with changed parameters</h2></div></div></div><p>Some functions have had the parameters updated.  Below are some of the more common ones.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_pdu_init"></a>5.1. coap_pdu_init()</h3></div></div></div><p>The definition of the second parameter has changed from <code class="literal">coap_request_t</code> to
<code class="literal">coap_pdu_code_t</code>.</p><p>Example</p><pre class="screen">4.2.1
  pdu = coap_pdu_init(msgtype,
                      COAP_REQUEST_GET,
                      coap_new_message_id(session),
                      coap_session_max_pdu_size(session));
4.3.0
  pdu = coap_pdu_init(msgtype,
                      COAP_REQUEST_CODE_GET,
                      coap_new_message_id(session),
                      coap_session_max_pdu_size(session));</pre><p>Note that the second parameter (<code class="literal">COAP_REQUEST_CODE_GET</code>) goes further than
just request codes and includes the possibility of response codes (e.g.
<code class="literal">COAP_RESPONSE_CODE_CREATED</code>) from the <code class="literal">enum coap_pdu_code_t</code>. Hence the
addition of <code class="literal">_CODE</code> in the parameter value.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_coap_get_data"></a>5.2. coap_get_data()</h3></div></div></div><p>The definition of the third parameter has been changed to be <code class="literal">const</code></p><p>Example</p><pre class="screen">4.2.1
  uint8_t *data;
  ...
  ret = coap_get_data(pdu, &amp;length, &amp;data);
4.3.0
  const uint8_t *data;
  ...
  ret = coap_get_data(pdu, &amp;length, &amp;data);</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_large_data_handling"></a>6. Large Data Handling</h2></div></div></div><p>Splitting up large data transmission into blocks (RFC7959) can now all be
handled by internally by libcoap, removing the need for applications to know
anything about how to work with blocks, or need to do any block packet loss
recovery. In simple terms, <code class="literal">coap_context_set_block_mode()</code> must be called,
<code class="literal">coap_add_data()</code> (or <code class="literal">coap_add_data_blocked_response()</code>) is replaced by
<code class="literal">coap_add_data_large_response()</code> or <code class="literal">coap_add_data_large_request()</code>, and
<code class="literal">coap_get_data_large()</code> used instead of <code class="literal">coap_get_data()</code>.  See man page
<code class="literal">coap_block(3)</code> for further information.</p><p>There are 3 ways of handling the block transfers</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_application_does_all_the_work"></a>6.1. Application does all the work</h3></div></div></div><p>This is how things were done in 4.2.1.  The application recognizes the next
block request coming in and then generates the next block response (including
setting up the PDU if client).  To continue using this method,
<code class="literal">coap_context_set_block_mode()</code> must not be called and none of the <code class="literal">_large</code>
functions used.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_application_sees_individual_blocks"></a>6.2. Application sees individual blocks</h3></div></div></div><p>By calling <code class="literal">coap_context_set_block_mode(context, COAP_BLOCK_USE_LIBCOAP)</code> and
using the <code class="literal">_large</code> functions, all the existing code that builds the next block
response is no longer needed (and must be removed to prevent packet
request/response duplication) as libcoap does this for the application.</p><p>By calling <code class="literal">coap_get_data_large()</code>, the application can determine if this is
the first block or not (using <code class="literal">offset</code> value), whether the first block is all
the data (<code class="literal">offset</code> = <code class="literal">0</code>, <code class="literal">length</code> = <code class="literal">total</code>) and whether this is the last
block (<code class="literal">offset</code> + <code class="literal">length</code> = <code class="literal">total</code>).  It is the responsibility of the
application to re-assemble the individual blocks into a single body of data.</p><p>If this is the request handler in a server, the server still needs to return a
<code class="literal">2.31 (Continue)</code> response code if the received data is not for the final block,
otherwise a <code class="literal">2.01 (Created)</code> or <code class="literal">2.04 (Changed)</code> should be returned.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_application_only_sees_all_the_data"></a>6.3. Application only sees all the data</h3></div></div></div><p>By calling <code class="literal">coap_context_set_block_mode(context,
COAP_BLOCK_USE_LIBCOAP|COAP_BLOCK_SINGLE_BODY)</code> and using the <code class="literal">_large</code>
functions, all the existing code that builds the next block response is no
longer needed (and must be removed to prevent request/response packet
duplication) as libcoap does this for the application.</p><p><code class="literal">coap_get_data_large()</code> will only return the entire body of data (<code class="literal">offset</code>
always <code class="literal">0</code>, <code class="literal">length</code> = <code class="literal">total</code>) and there is no need to re-assemble individual
blocks into a large body of data.</p><p>In RAM constrained environments, option 2 may be the preferred method.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_observe_handling"></a>7. Observe Handling</h2></div></div></div><p>In the server’s request handler’s call-back, there is no longer any need to
check whether this is an Observe call (or Observe triggered requesting
additional response call) and add in the Observe Option into the response pdu.
This is now added by libcoap, and trying to add in the Observe Option for the
second time in the call-back handler will throw up a Informational warning.</p><p>For the client, there is a new function <code class="literal">coap_cancel_observe()</code> that can be
called to cancel an observation on the server. To use it,
<code class="literal">coap_context_set_block_mode()</code> has to be called prior to sending the initial
request containing the Observe option.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_unused_function_parameters"></a>8. Unused function parameters</h2></div></div></div><p><code class="literal">UNUSED_PARAM</code> has been replaced with <code class="literal">COAP_UNUSED</code>. If <code class="literal">COAP_UNUSED</code> is used,
then the definition for <code class="literal">UNUSED_PARAM</code> can be removed.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_coap_message_ids"></a>9. CoAP Message IDs</h2></div></div></div><p><code class="literal">coap_tid_t</code> has been replaced with <code class="literal">coap_mid_t</code>, as well as <code class="literal">COAP_TID_INVALID</code>
has been replaced with <code class="literal">COAP_MID_INVALID</code>. This is so that the Message ID aligns
with the definition in RFC7252.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_async_support"></a>10. Async Support</h2></div></div></div><p>The <code class="literal">async</code> support has been re-written to simplify usage, and allows the
underlying libcoap to do the main management / work. A primary change is to
register the async request with a defined delay time before triggering - which
if set to 0 is an infinite time and the delay time subsequently updated if
required.  Consequently the <code class="literal">coap_async_*()</code> functions now have different
parameters.</p></div></div></body></html> 4.2.1_4.3.0</p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Sep 7 2024 00:02:05 for libcoap by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
